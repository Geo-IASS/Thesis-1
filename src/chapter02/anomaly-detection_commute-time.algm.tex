% TODO
\LinesNumbered

\SetKwInput{InputX}{$X$}
\SetKwInput{InputKnn}{$k_1$}
\SetKwInput{InputKscore}{$k_2$}
\SetKwInput{InputN}{$N$}
\SetKwInOut{Output}{outliers}

\InputX{Data matrix}
\InputKnn{the number of nearest neighbours to consider}
\InputKscore{for estimating the anomaly score}
\InputN{the number of anomalies to return}
\Output{the outliers that were discovered}

\SetKwData{varX}{$X$}
\SetKwData{varKnn}{$k_1$}
\SetKwData{varKscore}{$k_2$}
\SetKwData{varN}{$N$}
\SetKwData{varOutliers}{outliers}

\SetKwData{varKnnGraph}{knnGraph}
\SetKwData{varLaplacian}{$L$}
\SetKwData{varLaplacianInv}{$L^+$}

\SetKwFunction{ConstructKnnGraph}{constructKnnGraph}
\SetKwFunction{ConstructLaplacianMatrix}{constructLaplacianMatrix}
\SetKwFunction{ConstructInvLaplacianMatrix}{constructPseudoinverseLaplacianMatrix}
\SetKwFunction{FindOutliers}{TopN\_Outlier\_Pruning\_Block}

\Begin{
    $\varOutliers\longleftarrow\emptyset$\tcp*[l]{initialize to the empty set}
    \BlankLine
    $\varKnnGraph\longleftarrow\ConstructKnnGraph(\varX,\varKnn)$\;\tcp*[l]{Construct the mutual k-nearest neighbour graph from the dataset}
    $\varLaplacian\longleftarrow\ConstructLaplacianMatrix()$\;\tcp*[l]{Compute the graph Laplacian matrix L and its pseudoinverse L+}
    $\varOutliers\longleftarrow\FindOutliers()$\;\tcp*[l]{Find top N anomalies using the distance-based technique on commute time with pruning rule (using k2) described in Algorithm 1. The commute time between two nodes i and j can be computed using Equation 2.4}
    \KwRet{\varOutliers}\;
}
